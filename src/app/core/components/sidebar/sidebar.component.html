<div class="sidebar bg-dark">
  <div class="container">
    <span class="sidebar-title">PointOfSale.Web</span>
    <hr>
    @if (user) {
    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-link"><a routerLinkActive="active" routerLink=""><i class="bi bi-house"></i><span>Home</span></a>
      </li>
      <li class="nav-link"><a routerLinkActive="active" routerLink="/auth"><i
            class="bi bi-cart"></i><span>Orders</span></a>
      </li>
      <li class="nav-link"><a routerLinkActive="active" routerLink="/auth"><i
            class="bi bi-cash-coin"></i><span>Sales</span></a></li>
      <li class="nav-link"><a routerLinkActive="active" routerLink="/auth"><i
            class="bi bi-clipboard-check"></i><span>Inventory</span></a></li>
      @if (userPagePermission) {
      <li class="nav-link"><a routerLinkActive="active" routerLink="/auth"><i
            class="bi bi-person-gear"></i><span>Users</span></a></li>
      }

      <li class="nav-link user-info">
        <div class="col">
          <i class="bi bi-person-circle"></i>
          <span>{{user.username}}</span>
        </div>
        <div class="row">
          <p>{{user.role}}</p>
          <div class="options">
            <p class="btn btn-secondary btn-sm" (click)="signOut()">Sign Out</p>
            <p class="btn btn-secondary btn-sm" (click)="toggleChangePasswordModal(changePasswordModal)">Change Password
            </p>
          </div>
        </div>
      </li>
    </ul>
    }
  </div>
</div>

<ng-template #changePasswordModal let-modal>
  <div class="modal-body modal-sm">
    <form [formGroup]="passwordChangeForm" (ngSubmit)="onSubmit()">
      <h5 class="modal-title">Change Password</h5>
      @if (isSubmitting$ | async) {
      <app-loading-spinner></app-loading-spinner>
      } @else {
      <div>
        <input class="form-control" type="password" placeholder="Old Password" formControlName="oldPassword"
          autocomplete="off" />
        <small class="text-danger">
          {{ getPasswordErrorMessage("oldPassword") }}
        </small>
        <input class="form-control" type="password" placeholder="New Password" formControlName="newPassword"
          autocomplete="off" />
        <small class="text-danger">
          {{ getPasswordErrorMessage("newPassword") }}
        </small>
        <input class="form-control" type="password" placeholder="Repeat New Password"
          formControlName="repeatNewPassword" autocomplete="off" />
        <small class="text-danger">
          {{ getPasswordErrorMessage("repeatNewPassword") }}
        </small>
      </div>
      }

      <button type="submit" class="btn btn-dark" [disabled]="passwordChangeForm.invalid">
        <i class="bi bi-shield-exclamation"></i>&nbsp;
        Change Password
      </button>
    </form>
  </div>
</ng-template>